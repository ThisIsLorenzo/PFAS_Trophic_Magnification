---
title: "Code"
author: "Lorenzo Ricolfi"
date: "2024-03-27"
output: html_document
editor_options: 
  chunk_output_type: console
---
# Setup
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
# Loading packages
```{r}
#devtools::install_github("EIvimeyCook/ShinyDigitise")
library(tidyr)
library(dplyr)
library(here)
library(lmtest)
library(data.table)
library(metaDigitise)
library(sandwich)
#library(shinyDigitise)
```

# Raw data extracion - MetaDigitise
```{r}
dat <- metaDigitise("~/PhD/GitHub/PFAS_Trophic_Magnification/metaDigitise")
dat <- shinyDigitise("~/PhD/GitHub/PFAS_Trophic_Magnification/metaDigitise")
#write.csv(dat, file = "metaDigitise/MetaDigitise_Martin_2004_10r.csv")
```

# Data wrangling
Filtering and Transforming Data
```{r}
raw_data <- read.csv(here("metaDigitise/Raw_data.csv"))
head(raw_data)
# Reshaping Data with pivot_wider
wide_data <- raw_data %>%
  pivot_wider(
    names_from = variable,
    values_from = c(mean, sd),
    names_glue = "{variable}_{.value}"
  )
head(wide_data)
```

## S_052: Cara_2022
```{r}
Cara_2022 <- wide_data %>% 
  filter(Study_ID == "S_052") %>%
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  mutate(group_id = gsub("^(\\w+\\s[^,]+)", "\\1,", group_id)) %>% 
  separate(group_id, into = c("PFAS", "species", "location"), sep = ",\\s*", extra = "drop")

# Devide the Cara_2022 dataset into locations (food webs).

Cara_2022_loc4 <- Cara_2022 %>% 
  filter(location == "location 4") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOA_sd = PFOA_sd/(PFOA_mean*log(10))) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Cara_2022_loc4, file = here("Rdata", "Cara_2022_loc4.csv"))

Cara_2022_loc5 <- Cara_2022 %>% 
  filter(location == "location 5") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOA_sd = PFOA_sd/(PFOA_mean*log(10))) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  mutate(log_PFUnDA_sd = PFOA_sd/(PFUnDA_mean*log(10))) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Cara_2022_loc5, file = here("Rdata", "Cara_2022_loc5.csv"))

Cara_2022_loc8 <- Cara_2022 %>% 
  filter(location == "location 8") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOA_sd = PFOA_sd/(PFOA_mean*log(10))) %>%
  mutate(log_PFTrDA_mean = log10(PFTrDA_mean)) %>%
  mutate(log_PFTrDA_sd = PFOA_sd/(PFTrDA_mean*log(10))) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Cara_2022_loc8, file = here("Rdata", "Cara_2022_loc8.csv"))
```

## S_013: Martin_2004
```{r}
Martin_2004 <- wide_data %>% 
  filter(Study_ID == "S_013") %>%
  select_if(~ !all(is.na(.))) %>% 
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  mutate(group_id = gsub("^(\\w+\\s[^,]+)", "\\1,", group_id)) %>% 
  separate(group_id, into = c("PFAS", "species", "food_web"), sep = ",\\s*", extra = "drop")

Martin_2004_pelagic <- Martin_2004 %>% 
  filter(food_web == "pelagic food web") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.))))

#write.csv(Martin_2004_pelagic, file = here("Rdata", "Martin_2004_pelagic.csv"))

Martin_2004_benthic <- Martin_2004 %>% 
  filter(food_web == "benthic food web") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.))))

#write.csv(Martin_2004_benthic, file = here("Rdata", "Martin_2004_benthic.csv"))

Martin_2004_whole <- Martin_2004 %>%
  filter(food_web == "whole food web") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.))))

#write.csv(Martin_2004_whole, file = here("Rdata", "Martin_2004_whole.csv"))
```

## S_053: Koch_2020
```{r}
Koch_2020 <- wide_data %>% 
  filter(Study_ID == "S_053") %>%
  select_if(~ !all(is.na(.))) %>% 
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  mutate(group_id = gsub("^(\\w+\\s[^,]+)", "\\1,", group_id)) %>% 
  separate(group_id, into = c("PFAS", "species", "food_web"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOS_mean = log(PFOS_mean))

#write.csv(Koch_2020, file = here("Rdata", "Koch_2020.csv"))

Koch_2020_aquatic <- Koch_2020 %>% 
  filter(food_web == "aquatic food web") %>%
  select_if(~ !all(is.na(.)))
  
#write.csv(Koch_2020_aquatic, file = here("Rdata", "Koch_2020_aquatic.csv"))

Koch_2020_riparian <- Koch_2020 %>% 
  filter(food_web == "riparian food web") %>%
  select_if(~ !all(is.na(.)))

#write.csv(Koch_2020_riparian, file = here("Rdata", "Koch_2020_riparian.csv"))
```

## S_004: Mazzoni_2020
```{r}
Mazzoni_2020 <- wide_data %>% 
  filter(Study_ID == "S_004") %>%
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  separate(group_id, into = c("PFAS", "food_web", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))

Mazzoni_2020_fw1 <- Mazzoni_2020 %>% 
  filter(food_web == "food web 1") %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>%
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Mazzoni_2020_fw1, file = here("Rdata", "Mazzoni_2020_fw1.csv"))
  
Mazzoni_2020_fw2 <- Mazzoni_2020 %>% 
  filter(food_web == "food web 2") %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>%
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Mazzoni_2020_fw2, file = here("Rdata", "Mazzoni_2020_fw2.csv"))
```

## S_017: Liu_2018
```{r}
Liu_2018 <- wide_data %>% 
  filter(Study_ID == "S_017") %>%
  setDT() %>% 
  separate(group_id, into = c("PFAS", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.)))) %>%
  mutate(log_PFBA_mean = log10(PFBA_mean)) %>%
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFTrDA_mean = log10(PFTrDA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean))

#write.csv(Liu_2018, file = here("Rdata", "Liu_2018.csv"))
```

## S_019: Gao_2020
```{r}
Gao_2020 <- wide_data %>% 
  filter(Study_ID == "S_019") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT()

#write.csv(Gao_2020, file = here("Rdata", "Gao_2020.csv"))
```

## S_021: Chen_2018
```{r}
Chen_2018 <- wide_data %>% 
  filter(Study_ID == "S_021") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT()

#write.csv(Chen_2018, file = here("Rdata", "Chen_2018.csv"))
```

## S_023: Du_2021
```{r}
Du_2021 <- wide_data %>% 
  filter(Study_ID == "S_023") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT()

#write.csv(Du_2021, file = here("Rdata", "Du_2021.csv"))
```

## S_035: Ren_2022
```{r}
Ren_2022 <- wide_data %>% 
  filter(Study_ID == "S_035") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  separate(group_id, into = c("PFAS", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.)))) %>%
  mutate(log_PFHxS_mean = log10(PFHxS_mean)) %>%
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFTrDA_mean = log10(PFTrDA_mean)) %>%
  mutate(log_PFTeDA_mean = log10(PFTeDA_mean))

#write.csv(Ren_2022, file = here("Rdata", "Ren_2022.csv"))
```

## S_054: Koch_2021
```{r}
Koch_2021 <- wide_data %>% 
  filter(Study_ID == "S_054") %>%
  select_if(~ !all(is.na(.)))
```

## S_056: Li_2008
```{r}
Li_2008 <- wide_data %>% 
  filter(Study_ID == "S_056") %>%
  select_if(~ !all(is.na(.)))
```

## S_057: Pan_2010
```{r}
Pan_2010 <- wide_data %>% 
  filter(Study_ID == "S_057") %>%
  select_if(~ !all(is.na(.)))
```

## S_058: Van de Vijver_2003
```{r}
Van_de_Vijver_2003 <- wide_data %>% 
  filter(Study_ID == "S_058") %>%
  select_if(~ !all(is.na(.)))
```

# Regression analysis

## S_052: Cara_2022 - DONE
We have SD values. Weights are assigned.
### First food web - "location 4"
```{r}
Cara_2022_loc4 <- read.csv(here("RData", "Cara_2022_loc4.csv"))

Cara_2022_loc4_PFOA_weights <- 1 / (Cara_2022_loc4$log_PFOA_sd^2) # # weights as the inverse of square standard deviation. Please note we are taking the assumption that n is exactly the same for each observation

Cara_2022_loc4_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean, 
                                   data = Cara_2022_loc4,
                                   weights = Cara_2022_loc4_PFOA_weights)

#plot(residuals(Cara_2022_loc4_lm_model_PFOA))
#coeftest(Cara_2022_loc4_lm_model_PFOA, vcov. = vcovHC)
# or
summary(Cara_2022_loc4_lm_model_PFOA)
```

### Second food web - "location 5"
```{r}
Cara_2022_loc5 <- read.csv(here("RData", "Cara_2022_loc5.csv"))

Cara_2022_loc5_PFOA_weights <- 1 / (Cara_2022_loc5$log_PFOA_sd^2)
Cara_2022_loc5_PFUnDA_weights <- 1 / (Cara_2022_loc5$log_PFUnDA_sd^2)

Cara_2022_loc5_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean, 
                                   data = Cara_2022_loc5,
                                   weights = Cara_2022_loc5_PFOA_weights)

summary(Cara_2022_loc5_lm_model_PFOA)

Cara_2022_loc5_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean, 
                                     data = Cara_2022_loc5, 
                                     weights = Cara_2022_loc5_PFUnDA_weights)

summary(Cara_2022_loc5_lm_model_PFUnDA)
```

### Third food web - "location 8"
```{r}
Cara_2022_loc8 <- read.csv(here("RData", "Cara_2022_loc8.csv"))

Cara_2022_loc8_PFOA_weights <- 1 / (Cara_2022_loc8$log_PFOA_sd^2)
Cara_2022_loc8_PFTrDA_weights <- 1 / (Cara_2022_loc8$log_PFTrDA_sd^2)

Cara_2022_loc8_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean, 
                                   data = Cara_2022_loc8,
                                   weights = Cara_2022_loc8_PFOA_weights)

summary(Cara_2022_loc8_lm_model_PFOA)

Cara_2022_loc5_lm_model_PFTrDA <- lm(log_PFTrDA_mean ~ TL_mean, 
                                     data = Cara_2022_loc8, 
                                     weights = Cara_2022_loc8_PFTrDA_weights)

summary(Cara_2022_loc5_lm_model_PFTrDA)
```

## S_013: Martin_2004 - DONE
We have SE and we use it as weight.
### Benthic food web
Benthic food web includes only two TL values. SE values for benthic food web slope cannot be calculated.
```{r}
Martin_2004_benthic <- read.csv(here("RData/Martin_2004_benthic.csv"))

Martin_2004_benthic_PFOS_weights <- 1 / Martin_2004_benthic$se^2 # weights as the inverse of standard error

Martin_2004_benthic_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

plot(residuals(Martin_2004_benthic_lm_model_PFOS))

summary(Martin_2004_benthic_lm_model_PFOS)
```

### Pelagic food web
```{r}
Martin_2004_pelagic <- read.csv(here("RData", "Martin_2004_pelagic.csv"))

Martin_2004_pelagic_PFOS_weights <- 1 / Martin_2004_pelagic$se^2
Martin_2004_pelagic_PFOA_weights <- 1 / Martin_2004_pelagic$se^2
Martin_2004_pelagic_PFNA_weights <- 1 / Martin_2004_pelagic$se^2
Martin_2004_pelagic_PFDA_weights <- 1 / Martin_2004_pelagic$se^2
Martin_2004_pelagic_PFUnDA_weights <- 1 / Martin_2004_pelagic$se^2
Martin_2004_pelagic_PFDoDA_weights <- 1 / Martin_2004_pelagic$se^2
Martin_2004_pelagic_PFTrDA_weights <- 1 / Martin_2004_pelagic$se^2
Martin_2004_pelagic_PFTeDA_weights <- 1 / Martin_2004_pelagic$se^2

# PFOS
Martin_2004_pelagic_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFOS_weights)

summary(Martin_2004_pelagic_lm_model_PFOS)

# PFOA
Martin_2004_pelagic_lm_model_PFOA <- lm(ln_PFOA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFOA_weights)

summary(Martin_2004_pelagic_lm_model_PFOA)

# PFNA
Martin_2004_pelagic_lm_model_PFNA <- lm(ln_PFNA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFNA_weights)

summary(Martin_2004_pelagic_lm_model_PFNA)

# PFDA
Martin_2004_pelagic_lm_model_PFDA <- lm(ln_PFDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFDA_weights)

summary(Martin_2004_pelagic_lm_model_PFDA)

# PFUnDA
Martin_2004_pelagic_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFUnDA_weights)

summary(Martin_2004_pelagic_lm_model_PFUnDA)

# PFDoDA
Martin_2004_pelagic_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFDoDA_weights)

summary(Martin_2004_pelagic_lm_model_PFDoDA)

# PFTrDA
Martin_2004_pelagic_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFTrDA_weights)

summary(Martin_2004_pelagic_lm_model_PFTrDA)

# PFTeDA
Martin_2004_pelagic_lm_model_PFTeDA <- lm(ln_PFTeDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_PFTeDA_weights)

summary(Martin_2004_pelagic_lm_model_PFTeDA)
```

### Whole food web
```{r}
Martin_2004_whole <- read.csv(here("RData", "Martin_2004_whole.csv"))

Martin_2004_whole_FOSA_weights <- 1 / Martin_2004_whole$se^2

Martin_2004_whole_lm_model_FOSA <- lm(ln_FOSA_mean ~ TL_mean, 
                                        data = Martin_2004_whole,
                                        weights = Martin_2004_whole_FOSA_weights)

summary(Martin_2004_whole_lm_model_FOSA)
```

## S_053: Koch_2020 - DONE
We do not have SD or SE values. Weights cannot be assigned.
### Aquatic food web
```{r}
Koch_2020_aquatic <- read.csv(here("Rdata", "Koch_2020_aquatic.csv"))

Koch_2020_aquatic_lm_model_PFOS <- lm(log_PFOS_mean ~ delta_15N_mean,
                                      data = Koch_2020_aquatic)

summary(Koch_2020_aquatic_lm_model_PFOS)
```

### Riparian food web
```{r}
Koch_2020_riparian <- read.csv(here("Rdata", "Koch_2020_riparian.csv"))

Koch_2020_riparian_lm_model_PFOS <- lm(log_PFOS_mean ~ delta_15N_mean,
                                      data = Koch_2020_riparian)

summary(Koch_2020_riparian_lm_model_PFOS)

```

## S_004: Mazzoni_2020 - DONE
We do not have SD or SE values. Weights cannot be assigned.
### Food web 1 - including zooplankton
```{r}
Mazzoni_2020_fw1 <- read.csv(here("Rdata", "Mazzoni_2020_fw1.csv"))

# PFDA
Mazzoni_2020_fw1_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

summary(Mazzoni_2020_fw1_lm_model_PFDA)

# PFDoDA
Mazzoni_2020_fw1_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

summary(Mazzoni_2020_fw1_lm_model_PFDoDA)

# PFNA
Mazzoni_2020_fw1_lm_model_PFNA <- lm(log_PFNA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

summary(Mazzoni_2020_fw1_lm_model_PFNA)

# PFOS - The study already provides the TMS and SE for this compound
#Mazzoni_2020_fw1_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean, data = Mazzoni_2020_fw1)

#summary(Mazzoni_2020_fw1_lm_model_PFOS)

# PFUnDA
Mazzoni_2020_fw1_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

summary(Mazzoni_2020_fw1_lm_model_PFUnDA)
```

### Food web 2 - excluding zooplankton
```{r}
Mazzoni_2020_fw2 <- read.csv(here("Rdata", "Mazzoni_2020_fw2.csv"))

# PFDA
Mazzoni_2020_fw2_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw2_lm_model_PFDA)

# PFDoDA
Mazzoni_2020_fw2_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw2_lm_model_PFDoDA)

# PFOS
Mazzoni_2020_fw2_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw1_lm_model_PFOS)

# PFUnDA
Mazzoni_2020_fw2_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw2_lm_model_PFUnDA)
```

## S_017: Liu_2018 - DONE
We do not have SD or SE values. Weights cannot be assigned.
```{r}
Liu_2018 <- read.csv(here("Rdata", "Liu_2018.csv"))
# PFBA
Liu_2018_lm_model_PFBA <- lm(log_PFBA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFBA)
# PFOA
Liu_2018_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFOA)
# PFNA
Liu_2018_lm_model_PFNA <- lm(log_PFNA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFNA)
# PFDA
Liu_2018_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFDA)
# PFUnDA
Liu_2018_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFUnDA)
# PFDoDA
Liu_2018_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFDoDA)
# PFTrDA 
Liu_2018_lm_model_PFTrDA <- lm(log_PFTrDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFTrDA)
# PFOS
Liu_2018_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFOS)
```

## S_019: Gao_2020 - DONE
We have SD values. Weights are assigned.
```{r}
Gao_2020 <- read.csv(here("Rdata", "Gao_2020.csv"))
Gao_2020_PFHxS_weights <- 1 / (Gao_2020$log_PFHxS_sd^2)
Gao_2020_PFOS_weights <- 1 / (Gao_2020$log_PFOS_sd^2)
Gao_2020_PFBA_weights <- 1 / (Gao_2020$log_PFBA_sd^2)

# PFHxS
Gao_2020_lm_model_PFHxS <- lm(log_PFHxS_mean ~ TL_mean,
                              data = Gao_2020,
                              weights = Gao_2020_PFHxS_weights)

summary(Gao_2020_lm_model_PFHxS)

# PFOS
Gao_2020_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                             data = Gao_2020,
                             weights = Gao_2020_PFOS_weights)

summary(Gao_2020_lm_model_PFOS)

# PFBA
Gao_2020_lm_model_PFBA <- lm(log_PFBA_mean ~ TL_mean,
                             data = Gao_2020,
                             weights = Gao_2020_PFBA_weights)

summary(Gao_2020_lm_model_PFBA)
```

## S_021: Chen_2018 - DONE
We do not have SD or SE values. Weights cannot be assigned.
```{r}
Chen_2018 <- read.csv(here("Rdata", "Chen_2018.csv"))

# PFOS
Chen_2018_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFOS)

# PFDA
Chen_2018_lm_model_PFDA <- lm(ln_PFDA_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFDA)

# PFUnDA
Chen_2018_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFUnDA)

# PFDoDA
Chen_2018_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFDoDA)
```

## S_023: Du_2021 - DONE
```{r}
Du_2021 <- read.csv(here("Rdata", "Du_2021.csv"))

# PFBA
Du_2021_lm_model_PFBA <- lm(log_PFBA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFBA)

# PFHxA
Du_2021_lm_model_PFHxA <- lm(log_PFHxA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFHxA)

# PFOA
Du_2021_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFOA)

# PFUnDA
Du_2021_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFUnDA)

# PFTrDA
Du_2021_lm_model_PFTrDA <- lm(log_PFTrDA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFTrDA)

# PFBS
Du_2021_lm_model_PFBS <- lm(log_PFBS_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFBS)

# PFOS
Du_2021_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFOS)
```

## S_035: Ren_2022 - DONE
Data from Port Austin (USA) food web including benthic organisms.
```{r}
Ren_2022 <- read.csv(here("Rdata", "Ren_2022.csv"))

Ren_2022_weights <- 1 / Ren_2022$se^2

# PFHxS
Ren_2022_lm_model_PFHxS <- lm(log_PFHxS_mean ~ TL_mean,
                              data = Ren_2022,
                              weights = Ren_2022_weights)

summary(Ren_2022_lm_model_PFHxS)

# PFOS - we cannot assign weights because SE = 0
Ren_2022_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFOS)

# PFOA
Ren_2022_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFOA)

# PFNA
Ren_2022_lm_model_PFNA <- lm(log_PFNA_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFNA)

# PFDA
Ren_2022_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFDA)

# PFUnDA
Ren_2022_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFUnDA)

# PFDoDA
Ren_2022_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFDoDA)

# PFTrDA
Ren_2022_lm_model_PFTrDA <- lm(log_PFTrDA_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFTrDA)

# PFTeDA
Ren_2022_lm_model_PFTeDA <- lm(log_PFTeDA_mean ~ TL_mean,
                              data = Ren_2022)

summary(Ren_2022_lm_model_PFTeDA)

```

## S_054: Koch_2021
```{r}

```

## S_056: Li_2008
```{r}

```

## S_057: Pan_2010
```{r}

```

## S_058: Van de Vijver_2003
```{r}

```
