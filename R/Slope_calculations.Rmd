---
title: "Slope calculations"
author: "Lorenzo Ricolfi"
output:
  html_document:
    code_folding: show
    toc: yes
    toc_float: yes
    toc_collapsed: yes
    toc_depth: 3
    number_sections: no
    theme: cerulean
  pdf_document:
    toc: yes
    toc_depth: '2'
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
```

```{r, include=FALSE}
#devtools::install_github("EIvimeyCook/ShinyDigitise")
library(tidyr)
library(dplyr)
library(here)
library(lmtest)
library(data.table)
library(metaDigitise)
library(sandwich)
library(ggplot2)
#library(shinyDigitise)
```

<style>
.warning {
    background-color: #ffdddd; /* Light red background */
    border-left: 6px solid #f44336; /* Red left border */
    padding: 10px;
    margin-bottom: 15px;
}
</style>

<style>
.info {
    background-color: #d9edf7; /* Light blue background */
    border-left: 6px solid #31708f; /* Dark blue left border */
    padding: 10px;
    margin-bottom: 15px;
}
</style>

<style>
.info2 {
    background-color: #90EE90; /* Light red background */
    border-left: 6px solid #006400; /* Red left border */
    padding: 10px;
    margin-bottom: 15px;
    font-size: 16px;
}
</style>

<div class="info2">
Here, we calculate the Trophic magnification factor (TMF) for all those studies that do not report such value and/or its standard error. The TMF is calculated using PFAS concentrations and trophic levels (or stable nitrogen isotope values) data extracted from the included studies. 
</div>

# Data wrangling
```{r}
raw_data <- read.csv(here("metaDigitise/Raw_data.csv"))
head(raw_data)
# Reshaping Data with pivot_wider
wide_data <- raw_data %>%
  pivot_wider(
    names_from = variable,
    values_from = c(mean, sd),
    names_glue = "{variable}_{.value}"
  )
head(wide_data)
```

## S_052: Cara_2022
<div class="info">
- 3 food webs: location 4, 5, and 8.
- [PFAS] regressed on the original scale. We log-transformed them before running linear models.
- Standard deviations were log-scaled using the Delta method (Taylor approximation).
- Data were extracted from plots (Figure 6) using metaDigitise.
</div>
```{r}
Cara_2022 <- wide_data %>% 
  filter(Study_ID == "S_052") %>%
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  mutate(group_id = gsub("^(\\w+\\s[^,]+)", "\\1,", group_id)) %>% 
  separate(group_id, into = c("PFAS", "species", "location"), sep = ",\\s*", extra = "drop")

# Divide the Cara_2022 dataset into locations (food webs).

Cara_2022_loc4 <- Cara_2022 %>% 
  filter(location == "location 4") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOA_sd = PFOA_sd/(PFOA_mean*log(10))) %>% #Delta method (Taylor aproximation)
  select_if(~ !all(is.na(.)))

#write.csv(Cara_2022_loc4, file = here("Rdata", "Cara_2022_loc4.csv"))

Cara_2022_loc5 <- Cara_2022 %>% 
  filter(location == "location 5") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOA_sd = PFOA_sd/(PFOA_mean*log(10))) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  mutate(log_PFUnDA_sd = PFUnDA_sd/(PFUnDA_mean*log(10))) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Cara_2022_loc5, file = here("Rdata", "Cara_2022_loc5.csv"))

Cara_2022_loc8 <- Cara_2022 %>% 
  filter(location == "location 8") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOA_sd = PFOA_sd/(PFOA_mean*log(10))) %>%
  mutate(log_PFTrDA_mean = log10(PFTrDA_mean)) %>%
  mutate(log_PFTrDA_sd = PFTrDA_sd/(PFTrDA_mean*log(10))) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Cara_2022_loc8, file = here("Rdata", "Cara_2022_loc8.csv"))
```

## S_013: Martin_2004
<div class="info">
- 3 food webs: benthic, pelagic, and whole food web.
- Benthic food web only has 2 trophic levels included in the regression. Standard error cannot be calculated.
- [PFAS] already ln-tranformed.
- Data were extracted from plots (Figure 3) using metaDigitise.
</div>
```{r}
Martin_2004 <- wide_data %>% 
  filter(Study_ID == "S_013") %>%
  select_if(~ !all(is.na(.))) %>% 
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  mutate(group_id = gsub("^(\\w+\\s[^,]+)", "\\1,", group_id)) %>% 
  separate(group_id, into = c("PFAS", "species", "food_web"), sep = ",\\s*", extra = "drop")

Martin_2004_pelagic <- Martin_2004 %>% 
  filter(food_web == "pelagic food web") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.))))

#write.csv(Martin_2004_pelagic, file = here("Rdata", "Martin_2004_pelagic.csv"))

Martin_2004_benthic <- Martin_2004 %>% 
  filter(food_web == "benthic food web") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.))))

#write.csv(Martin_2004_benthic, file = here("Rdata", "Martin_2004_benthic.csv"))

Martin_2004_whole <- Martin_2004 %>%
  filter(food_web == "whole food web") %>%
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.))))

#write.csv(Martin_2004_whole, file = here("Rdata", "Martin_2004_whole.csv"))
```

## S_053: Koch_2020
<div class="info">
- 2 food webs: aquatic and riparian
- [PFAS] regressed on the original scale, although plots have y-axis on the log scale. We log-transformed them before running linear models.
- Data were extracted from plots (Figure 4) using Webplot Digitizer.
- [PFAS] regressed against delta15N.
</div>
```{r}
Koch_2020 <- wide_data %>% 
  filter(Study_ID == "S_053") %>%
  select_if(~ !all(is.na(.))) %>% 
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  mutate(group_id = gsub("^(\\w+\\s[^,]+)", "\\1,", group_id)) %>% 
  separate(group_id, into = c("PFAS", "species", "food_web"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean") | ends_with("sd"), ~ as.numeric(as.character(.)))) %>% 
  mutate(log_PFOS_mean = log10(PFOS_mean))

#write.csv(Koch_2020, file = here("Rdata", "Koch_2020.csv"))

Koch_2020_aquatic <- Koch_2020 %>% 
  filter(food_web == "aquatic food web") %>%
  select_if(~ !all(is.na(.)))
  
#write.csv(Koch_2020_aquatic, file = here("Rdata", "Koch_2020_aquatic.csv"))

Koch_2020_riparian <- Koch_2020 %>% 
  filter(food_web == "riparian food web") %>%
  select_if(~ !all(is.na(.)))

#write.csv(Koch_2020_riparian, file = here("Rdata", "Koch_2020_riparian.csv"))
```

## S_004: Mazzoni_2020
<div class="info">
- 2 food webs: including and excluding zooplankton.
- [PFAS] regressed on the original scale. We log-transformed them before running linear models.
- Data were extracted from tables (Table 1 and Table S5).
</div>
```{r}
Mazzoni_2020 <- wide_data %>% 
  filter(Study_ID == "S_004") %>%
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  separate(group_id, into = c("PFAS", "food_web", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))

Mazzoni_2020_fw1 <- Mazzoni_2020 %>% 
  filter(food_web == "food web 1") %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>%
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Mazzoni_2020_fw1, file = here("Rdata", "Mazzoni_2020_fw1.csv"))
  
Mazzoni_2020_fw2 <- Mazzoni_2020 %>% 
  filter(food_web == "food web 2") %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>%
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Mazzoni_2020_fw2, file = here("Rdata", "Mazzoni_2020_fw2.csv"))
```

## S_017: Liu_2018
<div class="info">
- 1 food web.
- [PFAS] regressed on the original scale. We ln-transformed them before running linear models.
- Data were extracted from tables (Table 1) and plots (Figure 4) using Webplot Digitizer.
</div>
```{r}
Liu_2018 <- wide_data %>% 
  filter(Study_ID == "S_017") %>%
  setDT() %>% 
  mutate(ln_PFBA_mean = log(PFBA_mean)) %>%
  mutate(ln_PFOA_mean = log(PFOA_mean)) %>%
  mutate(ln_PFNA_mean = log(PFNA_mean)) %>%
  mutate(ln_PFDA_mean = log(PFDA_mean)) %>%
  mutate(ln_PFUnDA_mean = log(PFUnDA_mean)) %>%
  mutate(ln_PFDoDA_mean = log(PFDoDA_mean)) %>%
  mutate(ln_PFTrDA_mean = log(PFTrDA_mean)) %>%
  mutate(ln_PFOS_mean = log(PFOS_mean)) %>%
  select_if(~ !all(is.na(.)))

#write.csv(Liu_2018, file = here("Rdata", "Liu_2018.csv"))
```

## S_019: Gao_2020
<div class="info">
- 1 food web.
- [PFAS] already log-tranformed.
- Data were extracted from plots (Figure 4) using metaDigitise.
</div>
```{r}
Gao_2020 <- wide_data %>% 
  filter(Study_ID == "S_019") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT()

#write.csv(Gao_2020, file = here("Rdata", "Gao_2020.csv"))
```

## S_021: Chen_2018
<div class="info">
- 1 food web.
- [PFAS] already ln-tranformed.
- Data were extracted from tables (Table 6).
</div>
```{r}
Chen_2018 <- wide_data %>% 
  filter(Study_ID == "S_021") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT()

#write.csv(Chen_2018, file = here("Rdata", "Chen_2018.csv"))
```

## S_023: Du_2021
<div class="info">
- 1 food web.
- [PFAS] already log-tranformed.
- Data were extracted from plots (Figure 4) using Webplot Digitizer.
</div>
```{r}
Du_2021 <- wide_data %>% 
  filter(Study_ID == "S_023") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT()

#write.csv(Du_2021, file = here("Rdata", "Du_2021.csv"))
```

## S_035: Ren_2022
<div class="info">
- 1 food web: Port Austin (USA), food web including benthic organisms.
- [PFAS] regressed on the original scale. We log-transformed them before running linear models.
- Data were extracted from tables (Table 1).
</div>
```{r}
Ren_2022 <- wide_data %>% 
  filter(Study_ID == "S_035") %>%
  select_if(~ !all(is.na(.))) %>%
  setDT() %>% 
  melt(id.vars = c("group_id"), na.rm = TRUE) %>% 
  dcast(group_id ~ variable, value.var = "value", fun.aggregate = max, na.rm = TRUE) %>% 
  separate(group_id, into = c("PFAS", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.)))) %>%
  mutate(log_PFHxS_mean = log10(PFHxS_mean)) %>%
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>%
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFTrDA_mean = log10(PFTrDA_mean)) %>%
  mutate(log_PFTeDA_mean = log10(PFTeDA_mean))

#write.csv(Ren_2022, file = here("Rdata", "Ren_2022.csv"))
```

## S_054: Koch_2021
<div class="info">
- 2 food webs: freshwater and terrestrial.
- [PFAS] already ln-tranformed.
- [PFAS] regressed against delta15N.
- Data were extracted from plots (Figure S10) using Webplot Digitizer.
</div>
```{r}
Koch_2021 <- wide_data %>% 
  filter(Study_ID == "S_054") %>%
  select_if(~ !all(is.na(.))) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>% 
  separate(group_id, into = c("PFAS", "food_web", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))
# food web 1 - freshwater
Koch_2021_freshwater <- Koch_2021 %>% 
  filter(food_web == "food web 1")
#write.csv(Koch_2021_freshwater, file = here("Rdata", "Koch_2021_freshwater.csv"))
# food web 2 - terrestrial
Koch_2021_terrestrial <- Koch_2021 %>% 
  filter(food_web == "food web 2")
#write.csv(Koch_2021_terrestrial, file = here("Rdata", "Koch_2021_terrestrial.csv"))
```

## S_056: Li_2008
<div class="info">
- 2 food webs: Tilapia included and excluded.
- [PFAS] already ln-tranformed.
- Data were extracted from plots (Figure 3) using Webplot Digitizer.
</div>
```{r}
Li_2008 <- wide_data %>% 
  filter(Study_ID == "S_056") %>%
  select_if(~ !all(is.na(.))) %>% 
  separate(group_id, into = c("PFAS", "food_web", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))
# food web 1 - Tilapia excluded
Li_2008_fw1 <- Li_2008 %>% 
  filter(food_web == "food web 1")
#write.csv(Li_2008_fw1, file = here("Rdata", "Li_2008_fw1.csv"))
# food web 2 - Tilapia included
Li_2008_fw2 <- Li_2008 %>% 
  filter(food_web == "food web 2")
#write.csv(Li_2008_fw2, file = here("Rdata", "Li_2008_fw2.csv"))
```

## S_057: Pan_2010
<div class="info">
- 1 food web.
- [PFAS] regressed on the original scale. We log-transformed them before running linear models.
- Data were extracted from plots (Figure S1) using Webplot Digitizer.
</div>
```{r}
Pan_2010 <- wide_data %>% 
  filter(Study_ID == "S_057") %>%
  select_if(~ !all(is.na(.))) %>%
  mutate(log_PFCs_mean = log10(PFCs_mean)) %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))

#write.csv(Pan_2010, file = here("Rdata", "Pan_2010.csv"))
```

## S_058: Van de Vijver_2003
<div class="info">
- 1 food web.
- [PFAS] regressed on the original scale. We log-transformed them before running linear models.
- Data were extracted from plots (Figure 3) using Webplot Digitizer.
</div>
```{r}
Van_de_Vijver_2003 <- wide_data %>% 
  filter(Study_ID == "S_058") %>%
  select_if(~ !all(is.na(.))) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))

#write.csv(Van_de_Vijver_2003, file = here("Rdata", "Van_de_Vijver_2003.csv"))
```

## S_061: Barghi_2018
<div class="info">
- 1 food web.
- [PFAS] regressed on the original scale. We log-transformed them before running linear models.
- Data were extracted from plots (Figure S2) using Webplot Digitizer.
</div>
```{r}
Barghi_2018 <- wide_data %>% 
  filter(Study_ID == "S_061") %>% 
  setDT() %>%
  select_if(~ !all(is.na(.))) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>% 
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))

#write.csv(Barghi_2018, file = here("Rdata", "Barghi_2018.csv"))
``` 

## S_060: Kobayashi_2018
<div class="info">
- 1 food web.
- [PFAS] on the original scale. We log-transformed them before running linear models.
- Data were extracted from tables (Table 1).
- Standard deviations were log-scaled using the Delta method (Taylor approximation).
</div>
```{r}
Kobayashi_2018 <- wide_data %>% 
  filter(Study_ID == "S_060") %>% 
  setDT() %>%
  select_if(~ !all(is.na(.))) %>%
  mutate(log_PFHxS_mean = log10(PFHxS_mean)) %>% 
  mutate(log_PFHxS_sd = PFHxS_sd/(PFHxS_mean*log(10))) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>% 
  mutate(log_PFOS_sd = PFOS_sd/(PFOS_mean*log(10))) %>%
  mutate(log_PFPeA_mean = log10(PFPeA_mean)) %>% 
  mutate(log_PFPeA_sd = PFPeA_sd/(PFPeA_mean*log(10))) %>%
  mutate(log_PFHxA_mean = log10(PFHxA_mean)) %>% 
  mutate(log_PFHxA_sd = PFHxA_sd/(PFHxA_mean*log(10))) %>%
  mutate(log_PFHpA_mean = log10(PFHpA_mean)) %>% 
  mutate(log_PFHpA_sd = PFHpA_sd/(PFHpA_mean*log(10))) %>%
  mutate(log_PFOA_mean = log10(PFOA_mean)) %>% 
  mutate(log_PFOA_sd = PFOA_sd/(PFOA_mean*log(10))) %>%
  mutate(log_PFNA_mean = log10(PFNA_mean)) %>% 
  mutate(log_PFNA_sd = PFNA_sd/(PFNA_mean*log(10))) %>%
  mutate(log_PFDA_mean = log10(PFDA_mean)) %>% 
  mutate(log_PFDA_sd = PFDA_sd/(PFDA_mean*log(10))) %>%
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean)) %>% 
  mutate(log_PFUnDA_sd = PFUnDA_sd/(PFUnDA_mean*log(10))) %>%
  mutate(across(ends_with("mean"), ~ as.numeric(as.character(.))))

#write.csv(Kobayashi_2018, file = here("Rdata", "Kobayashi_2018.csv"))
```

## S_047: Heimstad_2024
<div class="info">
- 1 food web.
- [PFAS] regressed on the original scale, although plots have y-axis on the log scale. We log-transformed them before running linear models.
- Data extracted from plots (Figure S10 - S12) using Webplot Digitizer.
</div>
```{r}
Heimstad_2024 <- wide_data %>% 
  filter(Study_ID == "S_047") %>% 
  setDT() %>%
  select_if(~ !all(is.na(.))) %>% 
  mutate(log_PFDoDA_mean = log10(PFDoDA_mean)) %>%
  mutate(log_PFOS_mean = log10(PFOS_mean)) %>% 
  mutate(log_PFUnDA_mean = log10(PFUnDA_mean))

#write.csv(Heimstad_2024, file = here("Rdata", "Heimstad_2024.csv"))
```

## S_024: Li_2021
<div class="info">
</div>
```{r}
Li_2021 <- wide_data %>% 
  filter(Study_ID == "S_024") %>% 
  setDT() %>%
  select_if(~ !all(is.na(.)))

#write.csv(Li_2021, file = here("Rdata", "Li_2021.csv"))
```

## S_025: Pan_2021
<div class="info">
</div>
```{r}
Pan_2021 <- wide_data %>% 
  filter(Study_ID == "S_025") %>% 
  setDT() %>%
  select_if(~ !all(is.na(.)))

#write.csv(Pan_2021, file = here("Rdata", "Pan_2021.csv"))
```

## S_059: Jiao_2023
<div class="info">
</div>
```{r}
Jiao_2023 <- wide_data %>% 
  filter(Study_ID == "S_059") %>% 
  setDT() %>%
  separate(group_id, into = c("PFAS", "tissue", "species"), sep = ",\\s*", extra = "drop") %>% 
  mutate(across(where(is.character), ~na_if(., ""))) %>% 
  select_if(~ !all(is.na(.)))

#write.csv(Jiao_2023, file = here("Rdata", "Jiao_2023.csv"))

# Divide the Jiao_2023 dataset into tissues.

Jiao_2023_blood <- Jiao_2023 %>% 
  filter(tissue == "blood")
#write.csv(Jiao_2023_blood, file = here("Rdata", "Jiao_2023_blood.csv"))
Jiao_2023_gill <- Jiao_2023 %>% 
  filter(tissue == "gill")
#write.csv(Jiao_2023_gill, file = here("Rdata", "Jiao_2023_gill.csv"))
Jiao_2023_heart <- Jiao_2023 %>% 
  filter(tissue == "heart")
#write.csv(Jiao_2023_heart, file = here("Rdata", "Jiao_2023_heart.csv"))
Jiao_2023_liver <- Jiao_2023 %>% 
  filter(tissue == "liver")
#write.csv(Jiao_2023_liver, file = here("Rdata", "Jiao_2023_liver.csv"))
Jiao_2023_kidney <- Jiao_2023 %>% 
  filter(tissue == "kidney")
#write.csv(Jiao_2023_kidney, file = here("Rdata", "Jiao_2023_kidney.csv"))
Jiao_2023_pancreas <- Jiao_2023 %>% 
  filter(tissue == "pancreas")
#write.csv(Jiao_2023_pancreas, file = here("Rdata", "Jiao_2023_pancreas.csv"))
Jiao_2023_muscle <- Jiao_2023 %>% 
  filter(tissue == "muscle")
#write.csv(Jiao_2023_muscle, file = here("Rdata", "Jiao_2023_muscle.csv"))
```


# Linear models

## S_052: Cara_2022
<div class="info">
- It provides standard deviations of individual observations. Weights were assigned (inverse of square standard deviation).
</div>

### First food web - "location 4"
```{r}
Cara_2022_loc4 <- read.csv(here("RData", "Cara_2022_loc4.csv"))

Cara_2022_loc4_PFOA_weights <- 1 / (Cara_2022_loc4$log_PFOA_sd^2) # weights as the inverse of square standard deviation. Please note we are taking the assumption that n is exactly the same for each observation. This is an assumption that must be taken in order to use the standard deviation of observations as weights.

Cara_2022_loc4_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean, 
                                   data = Cara_2022_loc4,
                                   weights = Cara_2022_loc4_PFOA_weights)

Cara_2022_loc4_PFOA_slope <- coef(Cara_2022_loc4_lm_model_PFOA)["TL_mean"]
#plot(residuals(Cara_2022_loc4_lm_model_PFOA))
#coeftest(Cara_2022_loc4_lm_model_PFOA, vcov. = vcovHC)
# or
summary(Cara_2022_loc4_lm_model_PFOA)
```

```{r}
ggplot(Cara_2022_loc4, aes(x = TL_mean, y = log_PFOA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFOA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Cara_2022_loc4_PFOA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

### Second food web - "location 5"
```{r}
Cara_2022_loc5 <- read.csv(here("RData", "Cara_2022_loc5.csv"))

Cara_2022_loc5_PFOA_weights <- 1 / (Cara_2022_loc5$log_PFOA_sd^2)
Cara_2022_loc5_PFUnDA_weights <- 1 / (Cara_2022_loc5$log_PFUnDA_sd^2)

Cara_2022_loc5_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean, 
                                   data = Cara_2022_loc5,
                                   weights = Cara_2022_loc5_PFOA_weights)

Cara_2022_loc5_PFOA_slope <- coef(Cara_2022_loc5_lm_model_PFOA)["TL_mean"]

summary(Cara_2022_loc5_lm_model_PFOA)
```

```{r}
ggplot(Cara_2022_loc5, aes(x = TL_mean, y = log_PFOA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFOA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Cara_2022_loc5_PFOA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```


```{r}
Cara_2022_loc5_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean, 
                                     data = Cara_2022_loc5, 
                                     weights = Cara_2022_loc5_PFUnDA_weights)

Cara_2022_loc5_PFUnDA_slope <- coef(Cara_2022_loc5_lm_model_PFUnDA)["TL_mean"]

summary(Cara_2022_loc5_lm_model_PFUnDA)
```

```{r}
ggplot(Cara_2022_loc5, aes(x = TL_mean, y = log_PFUnDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFUnDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Cara_2022_loc5_PFUnDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

### Third food web - "location 8"
```{r}
Cara_2022_loc8 <- read.csv(here("RData", "Cara_2022_loc8.csv"))

Cara_2022_loc8_PFOA_weights <- 1 / (Cara_2022_loc8$log_PFOA_sd^2)
Cara_2022_loc8_PFTrDA_weights <- 1 / (Cara_2022_loc8$log_PFTrDA_sd^2)

Cara_2022_loc8_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean, 
                                   data = Cara_2022_loc8,
                                   weights = Cara_2022_loc8_PFOA_weights)

Cara_2022_loc8_PFOA_slope <- coef(Cara_2022_loc8_lm_model_PFOA)["TL_mean"]

summary(Cara_2022_loc8_lm_model_PFOA)
```

```{r}
ggplot(Cara_2022_loc8, aes(x = TL_mean, y = log_PFOA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFOA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Cara_2022_loc8_PFOA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
Cara_2022_loc8_lm_model_PFTrDA <- lm(log_PFTrDA_mean ~ TL_mean, 
                                     data = Cara_2022_loc8, 
                                     weights = Cara_2022_loc8_PFTrDA_weights)

Cara_2022_loc8_PFTrDA_slope <- coef(Cara_2022_loc8_lm_model_PFTrDA)["TL_mean"]

summary(Cara_2022_loc8_lm_model_PFTrDA)
```

```{r}
ggplot(Cara_2022_loc8, aes(x = TL_mean, y = log_PFTrDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFTrDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Cara_2022_loc8_PFOA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

## S_013: Martin_2004
<div class="info">
- It provides standard errors of individual observations. Weights were assigned (inverse of standard error).
</div>

### Benthic food web
<div class="warning">
WARNING! Benthic food web includes only two trophic levels!
</div>
SE values for benthic food web slope cannot be calculated.
```{r}
Martin_2004_benthic <- read.csv(here("RData/Martin_2004_benthic.csv"))

Martin_2004_benthic_PFOS_weights <- 1 / Martin_2004_benthic$se^2 # weights as the inverse of standard error

# PFOS
Martin_2004_benthic_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFOS_slope <- coef(Martin_2004_benthic_lm_model_PFOS)["TL_mean"]

#plot(residuals(Martin_2004_benthic_lm_model_PFOS))

summary(Martin_2004_benthic_lm_model_PFOS)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFOS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFOS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFOS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```


```{r}
# PFOA
Martin_2004_benthic_lm_model_PFOA <- lm(ln_PFOA_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFOA_slope <- coef(Martin_2004_benthic_lm_model_PFOA)["TL_mean"]

summary(Martin_2004_benthic_lm_model_PFOA)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFOA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFOA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFOA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFNA
Martin_2004_benthic_lm_model_PFNA <- lm(ln_PFNA_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFNA_slope <- coef(Martin_2004_benthic_lm_model_PFNA)["TL_mean"]

summary(Martin_2004_benthic_lm_model_PFNA)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFNA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFNA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFNA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFDA
Martin_2004_benthic_lm_model_PFDA <- lm(ln_PFDA_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFDA_slope <- coef(Martin_2004_benthic_lm_model_PFDA)["TL_mean"]

summary(Martin_2004_benthic_lm_model_PFDA)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFUnDA
Martin_2004_benthic_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFUnDA_slope <- coef(Martin_2004_benthic_lm_model_PFUnDA)["TL_mean"]

summary(Martin_2004_benthic_lm_model_PFUnDA)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFUnDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFUnDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFUnDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```


```{r}
# PFDoDA
Martin_2004_benthic_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFDoDA_slope <- coef(Martin_2004_benthic_lm_model_PFDoDA)["TL_mean"]

summary(Martin_2004_benthic_lm_model_PFDoDA)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFDoDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFDoDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFDoDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFTrDA
Martin_2004_benthic_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFTrDA_slope <- coef(Martin_2004_benthic_lm_model_PFTrDA)["TL_mean"]

summary(Martin_2004_benthic_lm_model_PFTrDA)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFTrDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFTrDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFTrDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFTeDA
Martin_2004_benthic_lm_model_PFTeDA <- lm(ln_PFTeDA_mean ~ TL_mean, 
                                        data = Martin_2004_benthic,
                                        weights = Martin_2004_benthic_PFOS_weights)

Martin_2004_benthic_PFTeDA_slope <- coef(Martin_2004_benthic_lm_model_PFTeDA)["TL_mean"]

summary(Martin_2004_benthic_lm_model_PFTeDA)
```

```{r}
ggplot(Martin_2004_benthic, aes(x = TL_mean, y = ln_PFTeDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFTeDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_benthic_PFTeDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

### Pelagic food web

```{r}
Martin_2004_pelagic <- read.csv(here("RData", "Martin_2004_pelagic.csv"))

Martin_2004_pelagic_weights <- Martin_2004_pelagic$se^2

# PFOS
Martin_2004_pelagic_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_weights)

Martin_2004_pelagic_PFOS_slope <- coef(Martin_2004_pelagic_lm_model_PFOS)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFOS)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFOS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFOS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFOS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFOA
Martin_2004_pelagic_lm_model_PFOA <- lm(ln_PFOA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_weights)

Martin_2004_pelagic_PFOA_slope <- coef(Martin_2004_pelagic_lm_model_PFOA)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFOA)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFOA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFOA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFOA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFNA
Martin_2004_pelagic_lm_model_PFNA <- lm(ln_PFNA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_weights)

Martin_2004_pelagic_PFNA_slope <- coef(Martin_2004_pelagic_lm_model_PFNA)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFNA)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFNA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFNA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFNA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFDA
Martin_2004_pelagic_lm_model_PFDA <- lm(ln_PFDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_weights)

Martin_2004_pelagic_PFDA_slope <- coef(Martin_2004_pelagic_lm_model_PFDA)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFDA)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFUnDA
Martin_2004_pelagic_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_weights)

Martin_2004_pelagic_PFUnDA_slope <- coef(Martin_2004_pelagic_lm_model_PFUnDA)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFUnDA)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFUnDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFUnDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFUnDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFDoDA
Martin_2004_pelagic_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_weights)

Martin_2004_pelagic_PFDoDA_slope <- coef(Martin_2004_pelagic_lm_model_PFDoDA)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFDoDA)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFDoDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFDoDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFDoDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFTrDA
Martin_2004_pelagic_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic,
                                        weights = Martin_2004_pelagic_weights)

Martin_2004_pelagic_PFTrDA_slope <- coef(Martin_2004_pelagic_lm_model_PFTrDA)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFTrDA)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFTrDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFTrDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFTrDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFTeDA
Martin_2004_pelagic_lm_model_PFTeDA <- lm(ln_PFTeDA_mean ~ TL_mean, 
                                        data = Martin_2004_pelagic)

Martin_2004_pelagic_PFTeDA_slope <- coef(Martin_2004_pelagic_lm_model_PFTeDA)["TL_mean"]

summary(Martin_2004_pelagic_lm_model_PFTeDA)
```

```{r}
ggplot(Martin_2004_pelagic, aes(x = TL_mean, y = ln_PFTeDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [PFTeDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_pelagic_PFTeDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

### Whole food web
```{r}
Martin_2004_whole <- read.csv(here("RData", "Martin_2004_whole.csv"))

Martin_2004_whole_FOSA_weights <- 1 / Martin_2004_whole$se^2

Martin_2004_whole_lm_model_FOSA <- lm(ln_FOSA_mean ~ TL_mean, 
                                        data = Martin_2004_whole,
                                        weights = Martin_2004_whole_FOSA_weights)

Martin_2004_whole_FOSA_slope <- coef(Martin_2004_whole_lm_model_FOSA)["TL_mean"]

summary(Martin_2004_whole_lm_model_FOSA)
```

```{r}
ggplot(Martin_2004_whole, aes(x = TL_mean, y = ln_FOSA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "ln [FOSA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Martin_2004_whole_FOSA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

## S_053: Koch_2020
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>

### Aquatic food web
```{r}
Koch_2020_aquatic <- read.csv(here("Rdata", "Koch_2020_aquatic.csv"))

Koch_2020_aquatic_lm_model_PFOS <- lm(log_PFOS_mean ~ delta_15N_mean,
                                      data = Koch_2020_aquatic)

Koch_2020_aquatic_PFOS_slope <- coef(Koch_2020_aquatic_lm_model_PFOS)["delta_15N_mean"]

summary(Koch_2020_aquatic_lm_model_PFOS)
```

```{r}
ggplot(Koch_2020_aquatic, aes(x = delta_15N_mean, y = log_PFOS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "delta 15N",
       y = "ln [PFOS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Koch_2020_aquatic_PFOS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

### Riparian food web
```{r}
Koch_2020_riparian <- read.csv(here("Rdata", "Koch_2020_riparian.csv"))

Koch_2020_riparian_lm_model_PFOS <- lm(log_PFOS_mean ~ delta_15N_mean,
                                      data = Koch_2020_riparian)

Koch_2020_riparian_PFOS_slope <- coef(Koch_2020_riparian_lm_model_PFOS)["delta_15N_mean"]

summary(Koch_2020_riparian_lm_model_PFOS)
```

```{r}
ggplot(Koch_2020_riparian, aes(x = delta_15N_mean, y = log_PFOS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "delta 15N",
       y = "ln [PFOS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Koch_2020_riparian_PFOS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

## S_004: Mazzoni_2020
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>

### Food web 1 - including zooplankton
```{r}
Mazzoni_2020_fw1 <- read.csv(here("Rdata", "Mazzoni_2020_fw1.csv"))

# PFDA
Mazzoni_2020_fw1_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

Mazzoni_2020_fw1_PFDA_slope <- coef(Mazzoni_2020_fw1_lm_model_PFDA)["TL_mean"]

summary(Mazzoni_2020_fw1_lm_model_PFDA)
```

```{r}
ggplot(Mazzoni_2020_fw1, aes(x = TL_mean, y = log_PFDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Mazzoni_2020_fw1_PFDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFDoDA
Mazzoni_2020_fw1_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

Mazzoni_2020_fw1_PFDoDA_slope <- coef(Mazzoni_2020_fw1_lm_model_PFDoDA)["TL_mean"]

summary(Mazzoni_2020_fw1_lm_model_PFDoDA)
```

```{r}
ggplot(Mazzoni_2020_fw1, aes(x = TL_mean, y = log_PFDoDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFDoDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Mazzoni_2020_fw1_PFDoDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFNA
Mazzoni_2020_fw1_lm_model_PFNA <- lm(log_PFNA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

Mazzoni_2020_fw1_PFNA_slope <- coef(Mazzoni_2020_fw1_lm_model_PFNA)["TL_mean"]

summary(Mazzoni_2020_fw1_lm_model_PFNA)
```

```{r}
ggplot(Mazzoni_2020_fw1, aes(x = TL_mean, y = log_PFNA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFNA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Mazzoni_2020_fw1_PFNA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFOS - Note: The study already provides the TMS and SE for this compound
Mazzoni_2020_fw1_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean, data = Mazzoni_2020_fw1)

Mazzoni_2020_fw1_PFOS_slope <- coef(Mazzoni_2020_fw1_lm_model_PFOS)["TL_mean"]

summary(Mazzoni_2020_fw1_lm_model_PFOS)
```

```{r}
ggplot(Mazzoni_2020_fw1, aes(x = TL_mean, y = log_PFOS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFOS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Mazzoni_2020_fw1_PFOS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFUnDA
Mazzoni_2020_fw1_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw1)

Mazzoni_2020_fw1_PFUnDA_slope <- coef(Mazzoni_2020_fw1_lm_model_PFUnDA)["TL_mean"]

summary(Mazzoni_2020_fw1_lm_model_PFUnDA)
```

```{r}
ggplot(Mazzoni_2020_fw1, aes(x = TL_mean, y = log_PFUnDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFUnDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Mazzoni_2020_fw1_PFUnDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

### Food web 2 - excluding zooplankton
```{r}
Mazzoni_2020_fw2 <- read.csv(here("Rdata", "Mazzoni_2020_fw2.csv"))

# PFDA
Mazzoni_2020_fw2_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw2_lm_model_PFDA)

# PFDoDA
Mazzoni_2020_fw2_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw2_lm_model_PFDoDA)

# PFOS
Mazzoni_2020_fw2_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw2_lm_model_PFOS)

# PFUnDA
Mazzoni_2020_fw2_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                                      data = Mazzoni_2020_fw2)

summary(Mazzoni_2020_fw2_lm_model_PFUnDA)
```

## S_017: Liu_2018
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>
```{r}
Liu_2018 <- read.csv(here("Rdata", "Liu_2018.csv"))
# PFBA
Liu_2018_lm_model_PFBA <- lm(ln_PFBA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFBA)
# PFOA
Liu_2018_lm_model_PFOA <- lm(ln_PFOA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFOA)
# PFNA
Liu_2018_lm_model_PFNA <- lm(ln_PFNA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFNA)
# PFDA
Liu_2018_lm_model_PFDA <- lm(ln_PFDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFDA)
# PFUnDA
Liu_2018_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFUnDA)
# PFDoDA
Liu_2018_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFDoDA)
# PFTrDA 
Liu_2018_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFTrDA)
# PFOS
Liu_2018_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean,
                             data = Liu_2018)

summary(Liu_2018_lm_model_PFOS)
```

## S_019: Gao_2020
<div class="info">
- It provides standard deviations of individual observations. Weights were assigned (inverse of square standard deviation).
</div>
```{r}
Gao_2020 <- read.csv(here("Rdata", "Gao_2020.csv"))
Gao_2020_PFHxS_weights <- 1 / (Gao_2020$log_PFHxS_sd^2)
Gao_2020_PFOS_weights <- 1 / (Gao_2020$log_PFOS_sd^2)
Gao_2020_PFBA_weights <- 1 / (Gao_2020$log_PFBA_sd^2)

# PFHxS
Gao_2020_lm_model_PFHxS <- lm(log_PFHxS_mean ~ TL_mean,
                              data = Gao_2020,
                              weights = Gao_2020_PFHxS_weights)

summary(Gao_2020_lm_model_PFHxS)

# PFOS
Gao_2020_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                             data = Gao_2020,
                             weights = Gao_2020_PFOS_weights)

summary(Gao_2020_lm_model_PFOS)

# PFBA
Gao_2020_lm_model_PFBA <- lm(log_PFBA_mean ~ TL_mean,
                             data = Gao_2020,
                             weights = Gao_2020_PFBA_weights)

summary(Gao_2020_lm_model_PFBA)
```

## S_021: Chen_2018
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>
```{r}
Chen_2018 <- read.csv(here("Rdata", "Chen_2018.csv"))

# PFOS
Chen_2018_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFOS)

# PFDA
Chen_2018_lm_model_PFDA <- lm(ln_PFDA_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFDA)

# PFUnDA
Chen_2018_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFUnDA)

# PFDoDA
Chen_2018_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ TL_mean,
                             data = Chen_2018)

summary(Chen_2018_lm_model_PFDoDA)
```

## S_023: Du_2021
<div class="info">
- .
</div>
```{r}
Du_2021 <- read.csv(here("Rdata", "Du_2021.csv"))

# PFBA
Du_2021_lm_model_PFBA <- lm(log_PFBA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFBA)

# PFHxA
Du_2021_lm_model_PFHxA <- lm(log_PFHxA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFHxA)

# PFOA
Du_2021_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFOA)

# PFUnDA
Du_2021_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFUnDA)

# PFTrDA
Du_2021_lm_model_PFTrDA <- lm(log_PFTrDA_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFTrDA)

# PFBS
Du_2021_lm_model_PFBS <- lm(log_PFBS_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFBS)

# PFOS
Du_2021_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                             data = Du_2021)

summary(Du_2021_lm_model_PFOS)
```

## S_035: Ren_2022
<div class="info">
- It provides standard errors of individual observations. Weights were assigned (inverse of standard error).
</div>
```{r}
Ren_2022 <- read.csv(here("Rdata", "Ren_2022.csv"))

Ren_2022_weights <- 1 / Ren_2022$se^2

# PFHxS
Ren_2022_lm_model_PFHxS <- lm(log_PFHxS_mean ~ TL_mean,
                              data = Ren_2022,
                              weights = Ren_2022_weights)

Ren_2022_PFHxS_slope <- coef(Ren_2022_lm_model_PFHxS)["TL_mean"]

summary(Ren_2022_lm_model_PFHxS)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFHxS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFHxS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFHxS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFOS - we cannot assign weights because SE = 0
Ren_2022_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFOS_slope <- coef(Ren_2022_lm_model_PFOS)["TL_mean"]

summary(Ren_2022_lm_model_PFOS)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFOS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFOS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFOS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFOA
Ren_2022_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFOA_slope <- coef(Ren_2022_lm_model_PFOA)["TL_mean"]

summary(Ren_2022_lm_model_PFOA)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFOA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFOA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFOA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFNA
Ren_2022_lm_model_PFNA <- lm(log_PFNA_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFNA_slope <- coef(Ren_2022_lm_model_PFNA)["TL_mean"]

summary(Ren_2022_lm_model_PFNA)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFNA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFNA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFNA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFDA
Ren_2022_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFDA_slope <- coef(Ren_2022_lm_model_PFDA)["TL_mean"]

summary(Ren_2022_lm_model_PFDA)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```


```{r}
# PFUnDA
Ren_2022_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFUnDA_slope <- coef(Ren_2022_lm_model_PFUnDA)["TL_mean"]

summary(Ren_2022_lm_model_PFUnDA)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFUnDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFUnDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFUnDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFDoDA
Ren_2022_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFDoDA_slope <- coef(Ren_2022_lm_model_PFDoDA)["TL_mean"]

summary(Ren_2022_lm_model_PFDoDA)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFDoDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFDoDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFDoDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFTrDA
Ren_2022_lm_model_PFTrDA <- lm(log_PFTrDA_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFTrDA_slope <- coef(Ren_2022_lm_model_PFTrDA)["TL_mean"]

summary(Ren_2022_lm_model_PFTrDA)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFTrDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFTrDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFTrDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

```{r}
# PFTeDA
Ren_2022_lm_model_PFTeDA <- lm(log_PFTeDA_mean ~ TL_mean,
                              data = Ren_2022)

Ren_2022_PFTeDA_slope <- coef(Ren_2022_lm_model_PFTeDA)["TL_mean"]

summary(Ren_2022_lm_model_PFTeDA)
```

```{r}
ggplot(Ren_2022, aes(x = TL_mean, y = log_PFTeDA_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "Trophic level",
       y = "log [PFTeDA]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Ren_2022_PFTeDA_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

## S_054: Koch_2021
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>

### Food web 1 - freshwater
```{r}
Koch_2021_freshwater <- read.csv(here("Rdata", "Koch_2021_freshwater.csv"))
Koch_2021_freshwater_lm_model_PFOS <- lm(log_PFOS_mean ~ delta_15N_mean,
                                         data = Koch_2021_freshwater)

Koch_2021_freshwater_PFOS_slope <- coef(Koch_2021_freshwater_lm_model_PFOS)["delta_15N_mean"]

summary(Koch_2021_freshwater_lm_model_PFOS)
```

```{r}
ggplot(Koch_2021_freshwater, aes(x = delta_15N_mean, y = log_PFOS_mean)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE, color = "red", linewidth = 0.5) +
  labs(x = "delta 15N",
       y = "log [PFOS]") +
  theme_minimal() +
  annotate("text", x = Inf, y = Inf, label = paste("slope =", round(Koch_2021_freshwater_PFOS_slope, 3)), 
           hjust = 3, vjust = 5.5, size = 4, color = "red")
```

### Food web 2 - terrestrial
```{r}
Koch_2021_terrestrial <- read.csv(here("Rdata", "Koch_2021_terrestrial.csv"))

Koch_2021_terrestrial_lm_model_PFOS <- lm(log_PFOS_mean ~ delta_15N_mean,
                                         data = Koch_2021_terrestrial)

summary(Koch_2021_terrestrial_lm_model_PFOS)
```

## S_056: Li_2008
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>

### Food web 1 - Tilapia excluded
```{r}
Li_2008_fw1 <- read.csv(here("Rdata", "Li_2008_fw1.csv"))
Li_2008_fw1_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean,
                                data = Li_2008_fw1)

summary(Li_2008_fw1_lm_model_PFOS)
```

### Food web 2 - Tilapia included
```{r}
Li_2008_fw2 <- read.csv(here("Rdata", "Li_2008_fw2.csv"))
Li_2008_fw2_lm_model_PFOS <- lm(ln_PFOS_mean ~ TL_mean,
                                data = Li_2008_fw2)

summary(Li_2008_fw2_lm_model_PFOS)
```

## S_057: Pan_2010
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>
```{r}
Pan_2010 <- read.csv(here("Rdata", "Pan_2010.csv"))
Pan_2010_lm_model_PFOS <- lm(log_PFCs_mean ~ TL_mean,
                                data = Pan_2010)

summary(Pan_2010_lm_model_PFOS)
```

## S_058: Van de Vijver_2003
<div class="info">
- .
</div>
```{r}
Van_de_Vijver_2003 <- read.csv(here("Rdata", "Van_de_Vijver_2003.csv"))
Van_de_Vijver_2003_lm_model_PFOS <- lm(log_PFOS_mean ~ delta_15N_mean,
                                       data = Van_de_Vijver_2003)

summary(Van_de_Vijver_2003_lm_model_PFOS)
```

## S_061: Barghi_2018
<div class="info">
- .
</div>
```{r}
Barghi_2018 <- read.csv(here("Rdata", "Barghi_2018.csv"))

Barghi_2018_lm_model_PFNA <- lm(log_PFNA_mean ~ delta_15N_mean,
                                       data = Barghi_2018)

summary(Barghi_2018_lm_model_PFNA)
```

## S_060: Kobayashi_2018
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>
```{r}
Kobayashi_2018 <- read.csv(here("Rdata", "Kobayashi_2018.csv"))

# PFHxS
Kobayashi_2018_lm_model_PFHxS <- lm(log_PFHxS_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFHxS)

# PFOS
Kobayashi_2018_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFOS)
# PFPeA
Kobayashi_2018_lm_model_PFPeA <- lm(log_PFPeA_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFPeA)
# PFHxA
Kobayashi_2018_lm_model_PFHxA <- lm(log_PFHxA_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFHxA)
# PFHpA
Kobayashi_2018_lm_model_PFHpA <- lm(log_PFHpA_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFHpA)
# PFOA
Kobayashi_2018_lm_model_PFOA <- lm(log_PFOA_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFOA)
# PFNA
Kobayashi_2018_lm_model_PFNA <- lm(log_PFNA_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFNA)
# PFDA
Kobayashi_2018_lm_model_PFDA <- lm(log_PFDA_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFDA)
# PFUnDA
Kobayashi_2018_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                                    data = Kobayashi_2018)

summary(Kobayashi_2018_lm_model_PFUnDA)
```

## S_047: Heimstad_2024
<div class="info">
- .
</div>
```{r}
Heimstad_2024 <- read.csv(here("Rdata", "Heimstad_2024.csv"))

# PFOS
Heimstad_2024_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                                    data = Heimstad_2024)

summary(Heimstad_2024_lm_model_PFOS)

# PFUnDA
Heimstad_2024_lm_model_PFUnDA <- lm(log_PFUnDA_mean ~ TL_mean,
                                    data = Heimstad_2024)

summary(Heimstad_2024_lm_model_PFUnDA)

# PFDoDA
Heimstad_2024_lm_model_PFDoDA <- lm(log_PFDoDA_mean ~ TL_mean,
                                    data = Heimstad_2024)

summary(Heimstad_2024_lm_model_PFDoDA)
```

## S_024: Li_2021
<div class="info">
- .
</div>
```{r}
Li_2021 <- read.csv(here("Rdata", "Li_2021.csv"))

# HFPO-TeA
Li_2021_lm_model_HFPOTeA <- lm(log_HFPO.TeA_mean ~ TL_mean,
                                    data = Li_2021)

summary(Li_2021_lm_model_HFPOTeA)

# HFPO-TrA
Li_2021_lm_model_HFPOTrA <- lm(log_HFPO.TrA_mean ~ TL_mean,
                                    data = Li_2021)

summary(Li_2021_lm_model_HFPOTrA)

# PFO5DoA
Li_2021_lm_model_PFO5DoA <- lm(log_PFO5DoA_mean ~ TL_mean,
                                    data = Li_2021)

summary(Li_2021_lm_model_PFO5DoA)

# H-PFMO2OSA
Li_2021_lm_model_HPFMO2OSA <- lm(log_H.PFMO2OSA_mean ~ TL_mean,
                                    data = Li_2021)

summary(Li_2021_lm_model_HPFMO2OSA)

# PFOS
Li_2021_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                                    data = Li_2021)

summary(Li_2021_lm_model_PFOS)

# PFMOAA
Li_2021_lm_model_PFMOAA <- lm(log_PFMOAA_mean ~ TL_mean,
                                    data = Li_2021)

summary(Li_2021_lm_model_PFMOAA)

# PFBA
Li_2021_lm_model_PFBA <- lm(log_PFBA_mean ~ TL_mean,
                                    data = Li_2021)

summary(Li_2021_lm_model_PFBA)
```

## S_025: Pan_2021
<div class="info">
- .
</div>
```{r}
Pan_2021 <- read.csv(here("Rdata", "Pan_2021.csv"))

# 6:2 Cl-PFESA
Pan_2021_lm_model_62ClPFESA <- lm(log_62ClPFESA_mean ~ TL_mean,
                                    data = Pan_2021)

summary(Pan_2021_lm_model_62ClPFESA)

# PFOS
Pan_2021_lm_model_PFOS <- lm(log_PFOS_mean ~ TL_mean,
                                    data = Pan_2021)

summary(Pan_2021_lm_model_PFOS)
```


## S_059: Jiao_2023
<div class="info">
- It does not provide standard error or standard deviation values of individual observations. Weights cannot be assigned.
</div>
```{r}
Jiao_2023_blood <- read.csv(here("Rdata", "Jiao_2023_blood.csv"))

# PFDA
Jiao_2023_blood_lm_model_PFDA <- lm(ln_PFDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_PFDA)

# PFUnDA
Jiao_2023_blood_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_PFUnDA)

# PFDoDA
Jiao_2023_blood_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_PFDoDA)

# PFTrDA
Jiao_2023_blood_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_PFTrDA)

# PFOS
Jiao_2023_blood_lm_model_PFOS <- lm(ln_PFOS_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_PFOS)

# FOSA
Jiao_2023_blood_lm_model_FOSA <- lm(ln_FOSA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_FOSA)

# 62ClPFESA
Jiao_2023_blood_lm_model_62ClPFESA <- lm(ln_62ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_62ClPFESA)

# 82ClPFESA
Jiao_2023_blood_lm_model_82ClPFESA <- lm(ln_82ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_82ClPFESA)

# 102ClPFESA
Jiao_2023_blood_lm_model_102ClPFESA <- lm(ln_102ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_102ClPFESA)

# 103FTCA
Jiao_2023_blood_lm_model_103FTCA <- lm(ln_103FTCA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_blood)

summary(Jiao_2023_blood_lm_model_103FTCA)

Jiao_2023_gill <- read.csv(here("Rdata", "Jiao_2023_gill.csv"))

# PFDA
Jiao_2023_gill_lm_model_PFDA <- lm(ln_PFDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_gill)

summary(Jiao_2023_gill_lm_model_PFDA)

# PFDoDA
Jiao_2023_gill_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_gill)

summary(Jiao_2023_gill_lm_model_PFDoDA)

# PFTrDA
Jiao_2023_gill_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_gill)

summary(Jiao_2023_gill_lm_model_PFTrDA)

# 82ClPFESA
Jiao_2023_gill_lm_model_82ClPFESA <- lm(ln_82ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_gill)

summary(Jiao_2023_gill_lm_model_82ClPFESA)

Jiao_2023_heart <- read.csv(here("Rdata", "Jiao_2023_heart.csv"))

# PFDA
Jiao_2023_heart_lm_model_PFDA <- lm(ln_PFDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_heart)

summary(Jiao_2023_heart_lm_model_PFDA)

# PFUnDA
Jiao_2023_heart_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_heart)

summary(Jiao_2023_heart_lm_model_PFUnDA)

# PFDoDA
Jiao_2023_heart_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_heart)

summary(Jiao_2023_heart_lm_model_PFDoDA)

# PFTrDA
Jiao_2023_heart_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_heart)

summary(Jiao_2023_heart_lm_model_PFTrDA)

# 62ClPFESA
Jiao_2023_heart_lm_model_62ClPFESA <- lm(ln_62ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_heart)

summary(Jiao_2023_heart_lm_model_62ClPFESA)

Jiao_2023_kidney <- read.csv(here("Rdata", "Jiao_2023_kidney.csv"))

# PFUnDA
Jiao_2023_kidney_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_kidney)

summary(Jiao_2023_kidney_lm_model_PFUnDA)

# PFDoDA
Jiao_2023_kidney_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_kidney)

summary(Jiao_2023_kidney_lm_model_PFDoDA)

# PFTrDA
Jiao_2023_kidney_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_kidney)

summary(Jiao_2023_kidney_lm_model_PFTrDA)

Jiao_2023_liver <- read.csv(here("Rdata", "Jiao_2023_liver.csv"))

# PFDA
Jiao_2023_liver_lm_model_PFDA <- lm(ln_PFDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_liver)

summary(Jiao_2023_liver_lm_model_PFDA)

# PFUnDA
Jiao_2023_liver_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_liver)

summary(Jiao_2023_liver_lm_model_PFUnDA)

# PFDoDA
Jiao_2023_liver_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_liver)

summary(Jiao_2023_liver_lm_model_PFDoDA)

# PFTrDA
Jiao_2023_liver_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_liver)

summary(Jiao_2023_liver_lm_model_PFTrDA)

# 62ClPFESA
Jiao_2023_liver_lm_model_62ClPFESA <- lm(ln_62ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_liver)

summary(Jiao_2023_liver_lm_model_62ClPFESA)

# 82ClPFESA
Jiao_2023_liver_lm_model_82ClPFESA <- lm(ln_82ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_liver)

summary(Jiao_2023_liver_lm_model_82ClPFESA)

Jiao_2023_muscle <- read.csv(here("Rdata", "Jiao_2023_muscle.csv"))

# PFDoDA
Jiao_2023_muscle_lm_model_PFDoDA <- lm(ln_PFDoDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_muscle)

summary(Jiao_2023_muscle_lm_model_PFDoDA)

# PFTrDA
Jiao_2023_muscle_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_muscle)

summary(Jiao_2023_muscle_lm_model_PFTrDA)

# 62ClPFESA
Jiao_2023_muscle_lm_model_62ClPFESA <- lm(ln_62ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_muscle)

summary(Jiao_2023_muscle_lm_model_62ClPFESA)

Jiao_2023_pancreas <- read.csv(here("Rdata", "Jiao_2023_pancreas.csv"))

# PFUnDA
Jiao_2023_pancreas_lm_model_PFUnDA <- lm(ln_PFUnDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_pancreas)

summary(Jiao_2023_pancreas_lm_model_PFUnDA)

# PFTrDA
Jiao_2023_pancreas_lm_model_PFTrDA <- lm(ln_PFTrDA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_pancreas)

summary(Jiao_2023_pancreas_lm_model_PFTrDA)

# 62ClPFESA
Jiao_2023_pancreas_lm_model_62ClPFESA <- lm(ln_62ClPFESA_mean ~ delta_15N_mean,
                                    data = Jiao_2023_pancreas)

summary(Jiao_2023_pancreas_lm_model_62ClPFESA)
```

# References
-  Barghi_2018: Barghi, M., Jin, X., Lee, S., Jeong, Y., Yu, J. P., Paek, W. K., & Moon, H. B. (2018). Accumulation and exposure assessment of persistent chlorinated and fluorinated contaminants in Korean birds. Science of The Total Environment, 645, 220-228.
-  Cara_2022: Cara, B., Lies, T., Thimo, G., Robin, L., & Lieven, B. (2022). Bioaccumulation and trophic transfer of perfluorinated alkyl substances (PFAS) in marine biota from the Belgian North Sea: distribution and human health risk implications. Environmental Pollution, 311, 119907.
-  